<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">
<link rel="import" href="..\..\bower_components/paper-card/paper-card.html">
<link rel="import" href="..\..\bower_components/paper-fab/paper-fab.html">
<link rel="import" href="..\..\bower_components/paper-fab-transitions/paper-fab-speed-dial.html">
<link rel="import" href="..\..\bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="..\..\bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../gc-prayer-need/gc-prayer-need.html">

<dom-module id="gc-prayer-list">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <template is="dom-repeat" items="{{prayers}}" as="prayer">
      <paper-card heading="{{_computeHeading(prayer)}}" id="{{prayer.id}}">
        <div class="card-content">{{prayer.text}}{{prayer.text}}</div>
        <div class="card-actions">
          <paper-icon-button icon="create" on-tap="edit"></paper-icon-button>
          <paper-button>Я помолился</paper-button>
        </div>
      </paper-card>
    </template>

    <template is="dom-if" if="{{user}}">



      <paper-dialog id="testimony" modal>
        <h2>Свидетельство</h2>
        <paper-dialog-scrollable>
          Lorem ipsum...
        </paper-dialog-scrollable>
        <div class="buttons">
          <paper-button dialog-dismiss>Отмена</paper-button>
          <paper-button dialog-confirm>Добавить</paper-button>
        </div>
      </paper-dialog>

      <paper-fab-speed-dial direction="top" style="position:fixed;right:32px;bottom:32px">
        <paper-fab icon="add" class="dropdown-trigger"></paper-fab>
        <div class="dropdown-content">
        <span>
          <paper-tooltip position="left" animation-delay="200"> Новая молитвенная записка </paper-tooltip>
          <paper-fab mini icon="create" on-tap="openNewPrayer"></paper-fab>
        </span>
          <span>
            <paper-tooltip position="left" animation-delay="200"> Новое свидетельство </paper-tooltip>
            <paper-fab mini icon="record-voice-over" on-tap="openNewTestimony"></paper-fab>
          </span>
        </div>
      </paper-fab-speed-dial>

    </template>

  </template>
  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'gc-prayer-list',

        properties: {
          user:{
            type:Object
          },
          prayers: {
            type: Array,
            value: function(){
              return [
                {
                  id:132,
                  author: 'johnarcher',
                  title: 'Prayer request',
                  text:' this is a simple prayer request',
                  prayers: 5,
                  access:0,
                  active:true,
                  urgent:true,
                  allowComments:true
                },
                {
                  id:123,
                  author: 'johnarcher',
                  title: 'Prayer request#3',
                  text:' this is a simple prayer request#3',
                  prayers: 7,
                  access:0,
                  anonymous:true,
                  active:true
                },
                {
                  id:133,
                  author: 'johnarcher',
                  title: 'Prayer request',
                  text:' this is a simple prayer request',
                  prayers: 5,
                  access:0,
                  active:true,
                  urgent:true

                },
                {
                  id:143,
                  author: 'johnarcher',
                  title: 'Prayer request#3',
                  text:' this is a simple prayer request#3',
                  prayers: 7,
                  access:0,
                  anonymous:true,
                  active:true
                },
                {
                  id:154,
                  author: 'johnarcher',
                  title: 'Prayer request#2',
                  text:' this is a simple prayer request',
                  prayers: 10,
                  access:1,
                  active:false,
                  testimony:true
                }
              ]
            }
          }

        },
        _computeHeading:function(prayer){
          return prayer.anonymous?'Анонимно':prayer.author;
        },
        edit:function(e){
          var id= Polymer.dom(e).path.filter(function(item){return item.localName==='paper-card'})[0].id;
          var modal=this.create('gc-prayer-need',{user:this.user, edited:true, prayer: this.prayers.filter(function(prayer){return prayer.id===parseInt(id)})[0]});
          Polymer.dom(this.root).appendChild(modal);
          modal.open();
        },
        openNewPrayer:function(){
          var modal=this.create('gc-prayer-need',{user:this.user});
          Polymer.dom(this.root).appendChild(modal);
          modal.open();
        },
        openNewTestimony:function(){
          this.$$('#testimony').open();
        }
      });
    })();
  </script>
</dom-module>
